<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js">
(function($) {
    $(function() {
        $('.update').live('change', function() {
            formObject.run($(this));
        });
    });
})(jQuery);

var bookdata = [
    {
        picture: "https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1438077259l/22557520._SY475_.jpg",
        title: "After",
        author: "Anna Todd",
        genre: "Romance", 
        number: "592",
        summary: "Tessa is a good girl with a sweet, reliable boyfriend back home. She's got direction, ambition, and a mother who's intent on keeping her that way. But she's barely moved into her freshman dorm when she runs into Hardin. With his tousled brown hair, cocky british accent, tattoos, and a lip ring, Hardin is cute and different from what she's used to. But he's also rude-to the point of cruelty, even. For all his attitude, Tessa should hate Hardin. And she does-until she finds herself alone with him in his room. Something about his dark mood grabs her, and when tehy kiss it ignites with her a passion she's never known before. He'll call her beautiful, then insist he isn't the one for her and disappear again and again. Despite the reckless way he treats her, Tessa is compelled to dig deeper and find the real Hardin beneath all his lies. He pushes her away again and again, yet everytime she pushes back, he only pulls her in deeper. Tesse already has the perfect boyfriend. So why is she trying so hard to overcome her own hurt pride and Hardin's prejudice about nice girls like her? Unless...could this be love? Now newly revised and expanded, Anna Todd's After fanfiction racked up 1 billion reads online and captivated readers across the globe. Experience the Internet's most talked-about bookfor yourself! There was a time before Tessa met Hardin, and then there's everything AFTER ... Life will never be the same. ",
        link: "http://www.9novels.us/book2/u6379.html"
    },
    {
        picture: "https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1356109914l/5096865.jpg",
        title: "In Cold Blood",
        author: "Truman Capote",
        genre: "Crime", 
        number: "343",
        summary: "On November 15, 1959, in the small town of Holcomb, Kansas, four members of the Clutter family were savagely murdered by blasts from a shotgun held a few inches from their faces. There was no apparent motive for the crime, and there were almost no clues. As Truman Capote reconstructs the murder and the investigation that led to the capture, trial, and execution of the killers, he generates both mesmerizing suspense and astonishing empathy. At the center of his study are the amoral young killers Perry Smith and Dick Hickcock, who, vividly drawn by Capote, are shown to be reprehensible yet entirely and frighteningly human. In Cold Blood is a seminal work of modern prose, a remarkable synthesis of journalistic skill and powerfully evocative narrative. ",
        link: "https://onlinereadfreenovel.com/truman-capote/33794-in_cold_blood.html"
    },
    {
        picture: "https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1546406962l/16096824._SY475_.jpg",
        title: "A Court of Thorns and Roses",
        author: "Sarah J. Maas",
        genre: "Fantasy", 
        number: "448",
        summary: "Feyre's survival rests upon her ability to hunt and kill â€“ the forest where she lives is a cold, bleak place in the long winter months. So when she spots a deer in the forest being pursued by a wolf, she cannot resist fighting it for the flesh. But to do so, she must kill the predator and killing something so precious comes at a price ... Dragged to a magical kingdom for the murder of a faerie, Feyre discovers that her captor, his face obscured by a jewelled mask, is hiding far more than his piercing green eyes would suggest. Feyre's presence at the court is closely guarded, and as she begins to learn why, her feelings for him turn from hostility to passion and the faerie lands become an even more dangerous place. Feyre must fight to break an ancient curse, or she will lose him forever. ",
        link: "https://thefreenovelsread.com/244687-a-court-of-thorns-and-roses"
    },
    {
        picture: "https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1575073611l/1617.jpg",
        title: "Night",
        author: "Elie Wiesel",
        genre: "NonFiction", 
        number: "144",
        summary: "Born in the town of Sighet, Transylvania, Elie Wiesel was a teenager when he and his family were taken from their home in 1944 to Auschwitz concentration camp, and then to Buchenwald. Night is the terrifying record of Elie Wiesel's memories of the death of his family, the death of his own innocence, and his despair as a deeply observant Jew confronting the absolute evil of man. This new translation by his wife and most frequent translator, Marion Wiesel, corrects important details and presents the most accurate rendering in English of Elie Wiesel's testimony to what happened in the camps and of his unforgettable message that this horror must simply never be allowed to happen again. ",
        link: "https://www.yonkerspublicschools.org/cms/lib/NY01814060/Centricity/Domain/2503/NIGHT-FULL-TEXT-PDF.pdf"
    },
    {
        picture: "https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1474154022l/3._SY475_.jpg",
        title: "Harry Potter and the Sorcerer's Stone",
        author: "J. K. Rowling",
        genre: "Fiction", 
        number: "223",
        summary: "Harry Potter's life is miserable. His parents are dead and he's stuck with his heartless relatives, who force him to live in a tiny closet under the stairs. But his fortune changes when he receives a letter that tells him the truth about himself: he's a wizard. A mysterious visitor rescues him from his relatives and takes him to his new home, Hogwarts School of Witchcraft and Wizardry. After a lifetime of bottling up his magical powers, Harry finally feels like a normal kid. But even within the Wizarding community, he is special. He is the boy who lived: the only person to have ever survived a killing curse inflicted by the evil Lord Voldemort, who launched a brutal takeover of the Wizarding world, only to vanish after failing to kill Harry. Though Harry's first year at Hogwarts is the best of his life, not everything is perfect. There is a dangerous secret object hidden within the castle walls, and Harry believes it's his responsibility to prevent it from falling into evil hands. But doing so will bring him into contact with forces more terrifying than he ever could have imagined. Full of sympathetic characters, wildly imaginative situations, and countless exciting details, the first installment in the series assembles an unforgettable magical world and sets the stage for many high-stakes adventures to come. ",
        link: "https://readonlinenovels.com/nv/6eb2dc222c508599/harry-potter-h"
    },
    {
        picture: "http://prodimage.images-bn.com/pimages/9780345806789_p0_v2_s1200x630.jpg",
        title: "The Shining",
        author: "Stephen King",
        genre: "Horror", 
        number: "447",
        summary: "Jack Torrance's new job at the Overlook Hotel is the perfect chance for a fresh start. As the off-season caretaker at the atmospheric old hotel, he'll have plenty of time to spend reconnecting with his family and working on his writing. But as the harsh winter weather sets in, the idyllic location feels ever more remote...and more sinister. And the only one to notice the strange and terrible forces gathering around the Overlook is Danny Torrance, a uniquely gifted five-year-old. ",
        link: "https://allnovel.net/the-shining-the-shining-1.html"
    },
    {
        picture: "https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1360206420l/11870085.jpg",
        title: "The Fault in Our Stars",
        author: "John Green",
        genre: "Realistic Fiction", 
        number: "313",
        summary: "Despite the tumor-shrinking medical miracle that has bought her a few years, Hazel has never been anything but terminal, her final chapter inscribed upon diagnosis. But when a gorgeous plot twist named Augustus Waters suddenly appears at Cancer Kid Support Group, Hazel's story is about to be completely rewritten. Insightful, bold, irreverent, and raw, The Fault in Our Stars is award-winning author John Green's most ambitious and heartbreaking work yet, brilliantly exploring the funny, thrilling, and tragic business of being alive and in love. ",
        link: "https://novel80.com/242778-the-fault-in-our-stars.html"
    },
    {
        picture: "https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1491595510l/23513349.jpg",
        title: "Milk and Honey",
        author: "Rupi Kaur",
        genre: "Poetry", 
        number: "226",
        summary: "Milk and honey' is a collection of poetry and prose about survival. About the experience of violence, abuse, love, loss, and femininity. It is split into four chapters, and each chapter serves a different purpose. Deals with a different pain. Heals a different heartache. 'milk and honey' takes readers through a journey of the most bitter moments in life and finds sweetness in them because there is sweetness everywhere if you are just willing to look.  ",
        link: "https://fb2bookfree.com/adventure/983-milk-and-honey.html"
    },
];


$(function(){
    
    showBookLisitings();

    function showBookLisitings() {
        var localbookData = localStorage.hasOwnProperty('bookdata') ? JSON.parse(localStorage.getItem('bookdata')) : bookdata;

        if(!localStorage.hasOwnProperty('bookdata')) {
            localStorage.setItem('bookdata',JSON.stringify(localbookData));
        }

        var bookListStr = "";

        if(localbookData.length > 0) {
            $.each(localbookData, function(i,book) {
                bookListStr += '<div class="card card-body bg-light">';
                bookListStr += '<h1>'+book.title+'</h1>';
                bookListStr += '<h2>'+book.author+'</h2>';
                bookListStr += '<p>'+book.genre+'</p>';
                bookListStr += '<p>'+book.summary+'</p>';
                bookListStr += '<p><a target="_blank" href="'+book.link+'">'+book.link+'</a></p>';
                bookListStr += '</div>';
            });
        } else {
            bookListStr = "<h2>No Books found!!!</h2>"
        }
        console.log(bookListStr[1])
        $('#bookCards').html(bookListStr);
    }


   $('#submitBookPosting').on('click',function() {
        var title = $('#title').val();
        var author = $('#author').val();
        var genre = $('#genre').val();
        var summary = $('#summary').val();
        var link = $('#link').val();

        var bookObj = {};
            bookObj.title = title;
            bookObj.author = author;
            bookObj.genre = genre;
            bookObj.summary = summary;
            bookObj.link = link;

            //bookdata.push(bookObj);

            //get exisiting Books:
            var bookLisiting = JSON.parse(localStorage.getItem('bookdata'))
            bookLisiting.unshift(bookObj);
            localStorage.setItem('bookdata',JSON.stringify(bookLisiting));

            showBookLisitings();

    });


    //BookSearch

    $('.bookSearch').keyup(function(){

        var bookSearchStr = $(this).val();

        //if(bookSearchStr.length > 3) {
            var bookLisiting = JSON.parse(localStorage.getItem('bookdata'))

            var bookCardsBySearch = [];

            $.each(bookLisiting,function(i,book){ 
                if ((book.title.indexOf(bookSearchStr) !== -1 ) || ((book.location.indexOf(bookSearchStr) !== -1 ) ) || ((book.description.indexOf(bookSearchStr) !== -1 ) ) )   {
                    bookCardsBySearch.push(book);
                }
            })

            var bookListStr = "";
            if(bookCardsBySearch.length > 0) {
                $.each(bookCardsBySearch, function(i,book) {
                    bookListStr += '<div class="card card-body bg-light">';
                    bookListStr += '<h1>'+book.title+'</h1>';
                    bookListStr += '<h2>'+book.author+'</h2>';
                    bookListStr += '<p>'+book.genre+'</p>';
                    bookListStr += '<p>'+book.summary+'</p>';
                    bookListStr += '<p><a target="_blank" href="'+book.link+'">'+book.link+'</a></p>';
                    bookListStr += '</div>';
                });
            } else {
                bookListStr = "<h2>No Books found!!!</h2>"
            }
            $('#bookCards').html('').html(bookListStr);
            
            //showBookLisitings();
        //}
    })
    
}) 
</script>